(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"/MoV":function(e,t,s){"use strict";s.d(t,"c",(function(){return r})),s.d(t,"f",(function(){return c})),s.d(t,"d",(function(){return l})),s.d(t,"a",(function(){return u})),s.d(t,"g",(function(){return d})),s.d(t,"e",(function(){return h})),s.d(t,"b",(function(){return m}));var a=s("g6NE"),i=a.a.getters["config/configs"],o=a.a.getters["config/vars"],n=function(){return{timezone:i.system.timezone,defaultDateFormat:o.defaultDateFormat,defaultDateTimeFormat:o.defaultDateTimeFormat,serverDateFormat:o.serverDateFormat,serverDateTimeFormat:o.serverDateTimeFormat,calendarLocale:{sameDay:o.defaultTimeFormat,lastWeek:o.defaultDateFormat,sameElse:o.defaultDateFormat}}},r=function(e,t){var s=n(),a=moment(e,s.serverDateFormat);return e?(Array.isArray(e)&&(a=moment(e[0],e[1])),a.format(t||s.defaultDateFormat)):"INVALID DATE STRING"},c=function(e,t){var s=n(),a=moment(e,s.serverTimeFormat);return e?(Array.isArray(e)&&(a=moment(e[0],e[1])),a.format(t||s.defaultTimeFormat)):"INVALID TIME STRING"},l=function(e,t){var s=n(),a=moment(e,s.serverDateTimeFormat);return e?(Array.isArray(e)&&(a=moment(e[0],e[1])),a.format(t||s.defaultDateTimeFormat)):"INVALID DATE TIME STRING"},u=function(e,t){var s=n(),a=moment(e,s.serverDateTimeFormat);return e?(Array.isArray(e)&&(a=moment(e[0],e[1])),a.calendar(t||s.calendarLocale)):"INVALID DATE TIME STRING"},d=function(e,t,s){var a=n(),i=moment.utc("".concat(moment().format(a.serverDateFormat)," ").concat(e),a.serverTimeFormat);return e?(Array.isArray(e)&&(i=moment.utc(e[0],e[1])),i.tz(s||a.timezone).format(t||a.defaultTimeFormat)):"INVALID TIME STRING"},h=function(e,t,s){var a=n(),i=moment.utc(e,a.serverDateTimeFormat);return e?(Array.isArray(e)&&(i=moment.utc(e[0],e[1])),i.tz(s||a.timezone).format(t||a.defaultDateTimeFormat)):"INVALID DATE TIME STRING"},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=n(),i=moment.utc(e,a.serverDateTimeFormat);if(!e)return"INVALID DATE TIME STRING";Array.isArray(e)&&(i=moment.utc(e[0],e[1]));var o=i.tz(s||a.timezone);return o=o.calendar(t||a.calendarLocale)}},0:function(e,t){},"0D4p":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var a=s("Vjiq"),i=s("vDqi"),o=s.n(i),n=(s("eC5B"),s("g6NE")),r=function(){var e=n.a.getters["config/configs"],t=e.hasOwnProperty("pusher")?e.pusher:null;!window.Echo&&t&&t.pusherAppKey&&(window.Echo=new a.a({broadcaster:"pusher",cluster:t.pusherAppCluster,encrypted:!0,key:t.pusherAppKey,authorizer:function(e,t){return{authorize:function(t,s){o.a.post("/api/broadcasting/auth",{socket_id:t,channel_name:e.name}).then((function(e){e&&e.data?s(!1,e.data):console.error("Invalid Data!")})).catch((function(e){s(!0,e)}))}}}}),window.EchoOpts={subscriptions:{}})}},"1MQW":function(e,t,s){(t=e.exports=s("I1BE")(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css?family=Muli:300,400,600,700,800,900);",""]),t.push([e.i,".file-uploader .files-list-wrapper[data-v-020d1760]{margin-top:1rem}.file-uploader .files-list-wrapper .files-list[data-v-020d1760]{list-style:none;padding:0}.file-uploader .files-list-wrapper .files-list>.file-details-row[data-v-020d1760]{display:flex;transition:all .2s ease-in-out;background-color:#f8f9fd;overflow:hidden}.file-uploader .files-list-wrapper .files-list>.file-details-row[data-v-020d1760]:nth-child(2n){background-color:#e9ecf1}.file-uploader .files-list-wrapper .files-list>.file-details-row[data-v-020d1760]:first-child{border-radius:.25rem .25rem 0 0}.file-uploader .files-list-wrapper .files-list>.file-details-row[data-v-020d1760]:last-child{border-radius:0 0 .25rem .25rem}.file-uploader .files-list-wrapper .files-list>.file-details-row>*[data-v-020d1760]{padding:.4rem .6rem}.file-uploader .files-list-wrapper .files-list>.file-details-row .file-icon span[data-v-020d1760]{font-size:2rem;color:rgba(0,0,0,.3);display:flex;justify-content:center;align-items:center;width:3rem;height:3rem}.file-uploader .files-list-wrapper .files-list>.file-details-row .file-details[data-v-020d1760]{flex-grow:1;border-left:.0625rem solid rgba(0,0,0,.05)}.file-uploader .files-list-wrapper .files-list>.file-details-row .file-details h6[data-v-020d1760]{font-weight:600;margin-bottom:.2rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.file-uploader .files-list-wrapper .files-list>.file-details-row .file-details p[data-v-020d1760]{font-size:.75rem;color:rgba(0,0,0,.4);margin:0}.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper[data-v-020d1760],.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper>*[data-v-020d1760]{display:flex}.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper .status-action[data-v-020d1760],.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper .status-icon[data-v-020d1760],.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper .status-text[data-v-020d1760]{display:flex;justify-content:center;align-items:center;color:rgba(0,0,0,.3);margin:0 1rem}.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper .status-icon[data-v-020d1760]{font-size:2rem}.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper .status-action[data-v-020d1760]{color:#581b98;cursor:pointer}.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper.actions-wrapper[data-v-020d1760]{padding:0}.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper.actions-wrapper .actions-buttons .remove-btn[data-v-020d1760]{background-color:transparent;border:none;border-left:.0625rem solid rgba(0,0,0,.05);padding:0 1rem;color:#f5365c;cursor:pointer;transform:scale(1)}.file-uploader .files-list-wrapper .files-list>.file-details-row .status-wrapper.actions-wrapper .actions-buttons .remove-btn[data-v-020d1760]:hover{transform:scale(1.2)}.file-uploader .files-list-wrapper .files-list>.file-details-row[data-v-020d1760]:hover{background-color:#dee2e9}",""])},BcCH:function(e,t,s){"use strict";var a=s("XuX8"),i=new(s.n(a).a);t.a=i},DeGg:function(e,t,s){var a=s("1MQW");"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};s("aET+")(a,i);a.locals&&(e.exports=a.locals)},HLOy:function(e,t,s){"use strict";var a=s("DeGg");s.n(a).a},ICll:function(e,t,s){"use strict";s.d(t,"d",(function(){return i})),s.d(t,"b",(function(){return o})),s.d(t,"c",(function(){return n})),s.d(t,"a",(function(){return r}));var a=s("5TL6");function i(e,t){return Object(a.a)({url:e.url,method:"post",data:e.data,upload:!0,config:{headers:{"Content-Type":"multipart/form-data"}},headers:{"Content-Type":"multipart/form-data; charset=utf-8; boundary="+Math.random().toString().substr(2)},onUploadProgress:t})}function o(e){return Object(a.a)({url:e.url,method:"delete",data:e.data})}function n(e,t,s){return Object(a.a)({url:e.url,method:"post",data:e.data,upload:!0,config:{headers:{"Content-Type":"multipart/form-data"}},headers:{"Content-Type":"multipart/form-data; charset=utf-8; boundary="+Math.random().toString().substr(2)},onUploadProgress:t,cancelToken:s})}function r(e){return Object(a.a)({url:e.url,method:"delete",data:e.data})}},OjY7:function(e,t,s){"use strict";var a=s("vDqi"),i=s.n(a),o=s("ICll"),n=s("L2JU"),r=s("7Cbv"),c=s("BcCH"),l=s("nFxi");function u(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?u(Object(s),!0).forEach((function(t){h(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var m={name:"file-uploader",components:{},props:{data:{type:Array,default:function(){return[]}},additionalFormData:{type:Object,default:function(){return{}}},requestIdentifier:{type:String,default:Object(r.a)()},url:{type:String,default:"/uploads"},heading:{type:String,default:null},actionLabel:{type:String,default:"global.choose"},nameLabel:{type:String,default:"upload.file"},namesLabel:{type:String,default:"upload.files"},buttonWrapperClasses:{type:String,default:"justify-content-start"},headingClasses:{type:String,default:"mb-0"},buttonClasses:{type:String,default:""},buttonIcon:{type:String,default:"fas fa-upload"},buttonDesign:{type:String,default:"primary"},options:{type:Object,required:!0},autoUpload:{type:Boolean,default:!0},multiple:{type:Boolean,default:!0},hideButtonLabel:{type:Boolean,default:!1},hideFileList:{type:Boolean,default:!1},hideResetButton:{type:Boolean,default:!1},hideAfterUpload:{type:Boolean,default:!1},showSelectedFilesCount:{type:Boolean,default:!1}},data:function(){return{isLoading:!1,fileRemoved:!1,actionLabelUpdated:"",files:[],uploadedFiles:[],existingFiles:[],icons:l.b,mimeTypes:l.c}},computed:d(d({},Object(n.c)("config",["configs","vars"])),{},{computedActionLabel:function(){return this.existingFile?"global.change":this.actionLabel}}),watch:{data:function(e){this.existingFiles=e.map((function(e){return d(d({},e),{},{status:null})}))},"options.uuid":{deep:!0,handler:function(e,t){e&&e!==t&&this.reset()}}},methods:{getFileIcon:function(e){return this.icons[e]||"fa-file-alt"},getFileNameIcon:function(e){return this.icons[e]||"fa-file-alt"},generateFilesList:function(e){this.isLoading=!0;var t=null,s=this.$refs.filesInput.files;if(this.options.allowedExtensions&&(t=new RegExp("(."+this.options.allowedExtensions.join("|.")+")$")),this.options.maxNoOfFiles&&s.length+this.existingFiles.length>this.options.maxNoOfFiles)this.$toasted.error(this.$t("upload.max_file_limit_crossed",{number:this.options.maxNoOfFiles}),this.$toastConfig.error);else{for(var a=0;a<s.length;a++)t&&!t.test(s[a].name)?(this.isLoading=!1,this.$toasted.error(this.$t("global.file_not_supported",{attribute:s[a].name.split(".").pop()}),this.$toastConfig.error)):s[a].size>this.configs.system.postMaxSize?(this.isLoading=!1,this.$toasted.error(this.$t("global.file_too_large",{attribute:s[a].name}),this.$toastConfig.error)):this.files.push({uuid:Object(r.a)(),file:s[a],status:"waiting",progress:0});this.isLoading=!1,this.$emit("selected",this.files.length),this.autoUpload&&this.startUploading()}},startUploading:function(){var e=this;if(this.files.filter((function(e){return"waiting"===e.status})).length){var t=[],s=i.a.CancelToken;this.$emit("uploading",this.files.length);for(var a=function(a){var i=e.files[a];if(t[a]=function(e){i.progress=Math.round(100*e.loaded/e.total)},"waiting"===i.status){var n=new FormData;n.append("file",i.file),n.append("mime",i.file.type),n.append("token",e.options.token),n.append("module",e.options.module),n.append("request_uuid",e.requestIdentifier),n.append("first_attachment",0===a),n.append("last_attachment",a===e.files.length-1),e.additionalFormData.objForEach((function(e,t){e&&(_.isObject(e)?n.append(t.snakeCase(),JSON.stringify(e)):n.append(t.snakeCase(),e))})),i.status="uploading";var r=new s((function(e){i.cancel=e}));o.c({url:e.url,data:n},t[a],r).then((function(t){t.upload?e.uploadedFiles.push(t.upload):t.attachments&&e.uploadedFiles.push(t.attachments),i.uuid=t.upload?t.upload.uuid:t.uuid,i.status="justUploaded",delete i.cancel,setTimeout((function(){i.status="uploaded",e.hideAfterUpload&&e.files.splice(e.files.findIndex((function(e){return e.uuid===i.uuid})),1)}),2e3),e.$emit("updated",t),e.checkUploadStatus(t)})).catch((function(t){if(e.$emit("error",t),t.response&&t.response.data){var s=t.response.data||{},a=s.errors?formUtil.assignErrors(s.errors):{};i.error=a.message,e.$toasted.error(a.message,e.$toastConfig.error),i.status="error",setTimeout((function(){e.files.splice(e.files.findIndex((function(e){return e.uuid===i.uuid})),1)}),3e3),e.$emit("updated",t),e.checkUploadStatus()}else i.status="cancelled",setTimeout((function(){e.files.splice(e.files.findIndex((function(e){return e.uuid===i.uuid})),1)}),3e3)}))}},n=0;n<this.files.length;n++)a(n)}},removeFile:function(e,t){var s=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];formUtil.confirmAction().then((function(t){t.value&&(s.isLoading=!0,o.a({url:s.url+"/"+e.uuid,data:{token:s.options.token,module:s.options.module}}).then((function(t){e.status="removed",setTimeout((function(){a?s.existingFiles.splice(s.existingFiles.findIndex((function(t){return t.uuid===e.uuid})),1):s.files.splice(s.files.findIndex((function(t){return t.uuid===e.uuid})),1)}),3e3),s.isLoading=!1,s.$toasted.success(t.message,s.$toastConfig.success),s.$emit("selected",s.files.length),s.$emit("updated",t),s.checkUploadStatus()})).catch((function(t){var a=t.response.data||{},i=a.errors?formUtil.assignErrors(a.errors):{};s.$toasted.error(i.message,s.$toastConfig.error),e.error=i.message,e.status="removeError"})))}))},checkUploadStatus:function(e){for(var t=!0,s=0;s<this.files.length;s++)"justUploaded"!==this.files[s].status&&"uploaded"!==this.files[s].status&&(t=!1);t?this.$emit("uploaded",this.uploadedFiles):this.$emit("error")},reset:function(){this.isLoading=!1,this.fileRemoved=!1,this.actionLabelUpdated="",this.files=[],this.uploadedFiles=[];var e=this.$refs.filesInput;e.type="text",e.type="file",this.$emit("selected",this.files.length)},startUpload:function(){this.files.length?this.startUploading():this.$emit("noNeed")}},mounted:function(){c.a.$off("START_UPLOAD",this.startUpload),c.a.$on("START_UPLOAD",this.startUpload),c.a.$off("RESET_UPLOAD",this.reset),c.a.$on("RESET_UPLOAD",this.reset),this.existingFiles=this.data.map((function(e){return d(d({},e),{},{status:null})}))},filters:{decimal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(e).toFixed(t)}},destroyed:function(){c.a.$off("START_UPLOAD",this.startUpload),c.a.$off("RESET_UPLOAD",this.reset)}},f=(s("HLOy"),s("KHd+")),p=Object(f.a)(m,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-uploader file-uploader"},[s("div",{staticClass:"file-uploader-form"},[s("div",{class:["file-selector d-flex",e.buttonWrapperClasses]},[e.heading?s("h5",{class:["title-desc",e.headingClasses]},[e._v("\n                "+e._s(e.heading)+"\n            ")]):e._e(),e._v(" "),s("label",{class:["btn","btn-"+e.buttonDesign,e.buttonClasses]},[s("input",{ref:"filesInput",staticClass:"selector-input",attrs:{name:"filesInput",type:"file",id:"filesInput",multiple:e.multiple},on:{change:e.generateFilesList}}),e._v(" "),s("span",{staticClass:"button-icon"},[s("i",{class:e.buttonIcon})]),e._v(" "),e.hideButtonLabel?e._e():s("span",{staticClass:"button-label"},[e._v(e._s(e.$t(e.computedActionLabel,{attribute:e.$t(e.namesLabel)})))]),e._v(" "),e.showSelectedFilesCount&&e.files.length?s("span",{staticClass:"button-label bracketed"},[e._v(e._s(e.files.length))]):e._e()]),e._v(" "),e.hideFileList&&!e.hideResetButton&&e.files.length?s("button",{class:["btn","btn-"+e.buttonDesign,e.buttonClasses],attrs:{type:"button"},on:{click:e.reset}},[e._m(0)]):e._e()])]),e._v(" "),e.existingFiles.length||e.files.length?s("div",{class:["files-list-wrapper",{"d-none":e.hideFileList}]},[s("ul",{staticClass:"files-list"},[e._l(e.existingFiles,(function(t,a){return s("li",{staticClass:"file-details-row"},[s("div",{staticClass:"file-icon"},[s("span",[s("i",{class:["far",e.getFileIcon(t.mime)]})])]),e._v(" "),s("div",{staticClass:"file-details"},[s("h6",[e._v(e._s(t.filename))]),e._v(" "),t.error?s("p",{staticClass:"text-danger"},[e._v("\n                        "+e._s(t.error)+"\n                    ")]):s("p",[s("span",[s("span",{staticClass:"font-weight-700"},[e._v(e._s(e.$t("upload.type")))]),e._v(": "+e._s(e.mimeTypes[t.mime]||t.mime||"Unknown"))]),e._v(" "),s("span",{staticClass:"ml-1"},[s("span",{staticClass:"font-weight-700"},[e._v(e._s(e.$t("upload.size")))]),e._v(": "+e._s(e._f("decimal")(t.size/1024,0))+" KB")])])]),e._v(" "),s("div",{class:["status-wrapper",{"actions-wrapper":!t.status||"removeError"===t.status}]},[s("transition",{staticClass:"transition-wrapper",attrs:{appear:"",tag:"div",name:"actions",mode:"out-in"}},["removed"===t.status?s("div",{staticClass:"status-removed-wrapper"},[s("label",{staticClass:"status-text text-danger"},[e._v("Removed!")]),e._v(" "),s("span",{staticClass:"status-icon text-danger"},[s("i",{staticClass:"fas fa-trash"})])]):t.status&&"removeError"!==t.status?e._e():s("div",{staticClass:"actions-buttons"},["removeError"===t.status?s("label",{staticClass:"status-text text-danger"},[e._v("Error!")]):e._e(),e._v(" "),"removeError"===t.status?s("span",{staticClass:"status-icon text-danger"},[s("i",{staticClass:"fas fa-exclamation-triangle"})]):e._e(),e._v(" "),s("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.left",modifiers:{hover:!0,left:!0}}],staticClass:"remove-btn",attrs:{type:"button",title:e.$t("global.remove",{attribute:e.$t(e.nameLabel)})},on:{click:function(s){return e.removeFile(t,a,!0)}}},[s("i",{staticClass:"fas fa-trash"})])])])],1)])})),e._v(" "),e._l(e.files,(function(t,a){return s("li",{staticClass:"file-details-row"},[s("div",{staticClass:"file-icon"},[s("span",[s("i",{class:["far",e.getFileIcon(t.file.type)]})])]),e._v(" "),s("div",{staticClass:"file-details"},[s("h6",[e._v(e._s(t.file.name))]),e._v(" "),t.error?s("p",{staticClass:"text-danger"},[e._v("\n                        "+e._s(t.error)+"\n                    ")]):s("p",[s("span",[s("span",{staticClass:"font-weight-700"},[e._v(e._s(e.$t("upload.type")))]),e._v(": "+e._s(e.mimeTypes[t.file.type]||"Unknown"))]),e._v(" "),s("span",{staticClass:"ml-1"},[s("span",{staticClass:"font-weight-700"},[e._v(e._s(e.$t("upload.size")))]),e._v(": "+e._s(e._f("decimal")(t.file.size/1024,0))+" KB")])])]),e._v(" "),s("div",{class:["status-wrapper",{"actions-wrapper":"uploaded"===t.status||"removeError"===t.status}]},[s("transition",{staticClass:"transition-wrapper",attrs:{appear:"",tag:"div",name:"actions",mode:"out-in"}},["uploading"===t.status?s("div",{staticClass:"status-uploading-wrapper"},[s("label",{staticClass:"status-action",on:{click:t.cancel}},[e._v(e._s(e.$t("general.cancel")))]),e._v(" "),s("progress-ring",{attrs:{value:t.progress,"stroke-color":e.vars.loaderColor}})],1):"justUploaded"===t.status?s("div",{staticClass:"status-uploaded-wrapper"},[s("label",{staticClass:"status-text text-success"},[e._v("Uploaded!")]),e._v(" "),s("span",{staticClass:"status-icon text-success"},[s("i",{staticClass:"fas fa-check"})])]):"cancelled"===t.status?s("div",{staticClass:"status-cancelled-wrapper"},[s("label",{staticClass:"status-text text-danger"},[e._v("Cancelled!")]),e._v(" "),s("span",{staticClass:"status-icon text-danger"},[s("i",{staticClass:"fas fa-times"})])]):"removed"===t.status?s("div",{staticClass:"status-removed-wrapper"},[s("label",{staticClass:"status-text text-danger"},[e._v("Removed!")]),e._v(" "),s("span",{staticClass:"status-icon text-danger"},[s("i",{staticClass:"fas fa-trash"})])]):"error"===t.status?s("div",{staticClass:"status-error-wrapper"},[s("label",{staticClass:"status-text text-danger"},[e._v("Error!")]),e._v(" "),s("span",{staticClass:"status-icon text-danger"},[s("i",{staticClass:"fas fa-exclamation-triangle"})])]):"uploaded"===t.status||"removeError"===t.status?s("div",{staticClass:"actions-buttons"},["removeError"===t.status?s("label",{staticClass:"status-text text-danger"},[e._v("Error!")]):e._e(),e._v(" "),"removeError"===t.status?s("span",{staticClass:"status-icon text-danger"},[s("i",{staticClass:"fas fa-exclamation-triangle"})]):"uploaded"===t.status?s("label",{staticClass:"status-text text-success"},[e._v("Uploaded!")]):e._e(),e._v(" "),s("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.left",modifiers:{hover:!0,left:!0}}],staticClass:"remove-btn",attrs:{type:"button",title:e.$t("global.remove",{attribute:e.$t(e.nameLabel)})},on:{click:function(s){return e.removeFile(t,a)}}},[s("i",{staticClass:"fas fa-trash"})])]):e._e()])],1)])}))],2)]):e._e()])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"button-icon"},[t("i",{staticClass:"fas fa-times"})])}],!1,null,"020d1760",null);t.a=p.exports},akQX:function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"e",(function(){return u})),s.d(t,"c",(function(){return m})),s.d(t,"b",(function(){return f})),s.d(t,"d",(function(){return p}));var a=s("V0LQ");navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert($t("misc.get_user_media_not_supported")),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=function(e){navigator.mediaDevices.enumerateDevices().then(e)});var i="https:"===location.protocol,o=[],n=!1;("undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack||navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)&&(n=!0);var r={hasMicrophone:!1,hasWebcam:!1,isMicrophoneAlreadyCaptured:!1,isWebcamAlreadyCaptured:!1,permissionError:!0},c=function(e){n&&(!navigator.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(navigator.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!navigator.enumerateDevices&&navigator.enumerateDevices&&(navigator.enumerateDevices=navigator.enumerateDevices.bind(navigator)),navigator.enumerateDevices?(o=[],navigator.enumerateDevices((function(t){t.forEach((function(e){var t,s={};for(var a in e)s[a]=e[a];"audio"===s.kind&&(s.kind="audioinput"),"video"===s.kind&&(s.kind="videoinput"),o.forEach((function(e){e.id===s.id&&e.kind===s.kind&&(t=!0)})),t||(s.deviceId||(s.deviceId=s.id),s.id||(s.id=s.deviceId),s.label?("videoinput"!==s.kind||r.isWebcamAlreadyCaptured||(r.isWebcamAlreadyCaptured=!0),"audioinput"!==s.kind||r.isMicrophoneAlreadyCaptured||(r.isMicrophoneAlreadyCaptured=!0)):(s.label="Please invoke getUserMedia once.",i||(s.label="HTTPs is required to get label of this "+s.kind+" device.")),"audioinput"===s.kind&&(r.hasMicrophone=!0),"videoinput"===s.kind&&(r.hasWebcam=!0),o.push(s))})),e&&e(r)}))):e&&e(r))},l=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c((function(s){if(s){var a=!1;e&&!s.hasMicrophone&&(a=!0),t&&!s.hasWebcam&&(a=!0),a&&d(s)}}))},u=function(e){var t={icon:"error",footer:$t("misc.solve_and_refresh")};if(e)return"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?(t.title=$t("misc.media.permission_denied"),t.text=$t("misc.media.permission_denied_text")):"NotFoundError"===e.name?(t.title=$t("misc.media.not_found"),t.text=$t("misc.media.not_found_text")):"NotReadableError"===e.name?(t.title=$t("misc.media.unreadable"),t.text=$t("misc.media.unreadable_text")):"SecurityError"!==e.name&&"TypeError"!==e.name||(t.title=$t("misc.media.security"),t.text=$t("misc.media.security_text")),swtAlert.fire(t),t},d=function(e){var t=[];e.hasMicrophone||t.push("Microphone"),e.hasWebcam||t.push("WebCam");var s={icon:"error",title:$t("misc.media.missing"),text:$t("misc.media.missing_text",{attribute:t.join(", ")}),footer:$t("misc.solve_and_refresh")};swtAlert.fire(s)},h=function(e){if((e=Object.assign({},{type:null,loop:!1,duration:1e3},e)).type){var t=new Audio;return t.preload="auto",t.autoplay=!0,t.loop=e.loop,t.src="/sound/".concat(e.type,".mp3"),t.play().then((function(){setTimeout((function(){t&&t.pause()}),e.duration)})).catch((function(e){console.error(e)})),t}},m=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return h({type:"calling",loop:!0,duration:3e4})},f=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return h({type:"message",duration:3e3})},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,s=document.querySelector("link[rel=canonical]")?document.querySelector("link[rel=canonical]").href:document.location.href,i=e.url?e.url:s;if(navigator.share)navigator.share({title:e.title?e.title:document.title,url:i}).then((function(){console.log("Thanks for sharing!")})).catch(console.error);else{var o={text:$t("misc.share_alert.text"),showCancelButton:!0,confirmButtonText:$t("misc.share_alert.confirm_btn"),cancelButtonText:$t("misc.share_alert.cancel_btn")};swtAlert.fire(o).then((function(e){e.value&&(Object(a.b)(i),setTimeout((function(){t()}),500))}))}}},bdEB:function(e,t,s){"use strict";var a=s("L2JU");function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r={props:{place:{type:String,default:"normal"},size:{type:String,default:"normal"},appLogo:{type:Boolean,default:!1},inline:{type:Boolean,default:!1}},data:function(){return{appLogoText:window.kmenv.name}},computed:o(o({},Object(a.c)("config",["configs","uiConfigs"])),{},{orgLogo:function(){if(this.appLogo||!this.configs.assets)return"navbar"===this.place||"sidebar"===this.place||"dark"===this.place?"/images/logo-light.png":"/images/logo.png";var e=this.configs.assets.logo||"/images/logo.png";return this.configs.assets.logoLight&&("navbar"===this.place&&this.uiConfigs.topNavbarLogoLight||"sidebar"===this.place&&this.uiConfigs.leftSidebarLogoLight||"dark"===this.place)&&(e=this.configs.assets.logoLight),e},appTitle:function(){return this.configs.basic?this.configs.basic.orgName:window.kmenv.name}})},c=s("KHd+"),l=Object(c.a)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a",{class:["logo",e.place+"-logo",e.size+"-logo",e.orgLogo?"org-logo":"app-logo",e.inline?"inline-logo":""],attrs:{href:"/"}},[e.orgLogo?s("img",{staticClass:"logo-icon",attrs:{src:e.orgLogo,alt:e.appTitle}}):[s("span",{staticClass:"logo-text",attrs:{title:e.appTitle}},[e._v(e._s(e.appLogoText))])]],2)}),[],!1,null,null,null);t.a=l.exports},zfsR:function(e,t,s){"use strict";var a=s("L2JU"),i=s("0D4p"),o=s("i8R7"),n=s("akQX"),r=s("lUM2"),c=s("gFX4"),l=s.n(c),u=s("OjY7"),d={props:{activeContainer:{type:String,default:"home",required:!0}}},h=s("KHd+"),m=Object(h.a)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat-box-header"},[s("h6",{staticClass:"cb-header-title"},[e._v(e._s(e.$t("chat.live_chat")))]),e._v(" "),s("div",{staticClass:"cb-header-buttons"},["home"!==e.activeContainer?s("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("goHome")}}},[s("i",{class:["fas",{"fa-chevron-left":"conversation"===e.activeContainer},{"fa-chevron-right":"settings"===e.activeContainer}]})]):e._e(),e._v(" "),"settings"!==e.activeContainer?s("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("toggleSearch")}}},[s("i",{staticClass:"fas fa-search"})]):e._e(),e._v(" "),s("button",{staticClass:"d-none",attrs:{type:"button"},on:{click:function(t){return e.$emit("goToSettings")}}},[s("i",{staticClass:"fas fa-cog"})]),e._v(" "),s("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("hideChatBox")}}},[s("i",{staticClass:"fas fa-times"})])])])}),[],!1,null,null,null).exports,f={props:{}},p=Object(h.a)(f,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"chats-settings"},[t("vue-scroll",{ref:"vue-scroll-settings",attrs:{id:"vue-scroll-settings"}},[t("div",{staticClass:"settings-wrapper"},[this._v("\n            Chat related settings\n        ")])])],1)}),[],!1,null,null,null).exports,g={props:{room:{type:Object,required:!0},roomName:{type:String,required:!0},vars:{type:Object,default:function(){return{}}}},computed:{computedAvatar:function(){return this.room.isGroup||!this.room.member?this.room:this.room.member}},methods:{goToConversation:function(){this.room.isGroup||this.room.member?this.$emit("goToConversation",{room:this.room,user:null}):this.$emit("goToConversation",{room:null,user:this.room})}}},v=Object(h.a)(g,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",{class:["room-item"],on:{click:e.goToConversation}},[s("div",{staticClass:"item-thumb"},[s("user-avatar",{attrs:{user:e.computedAvatar,size:40}})],1),e._v(" "),s("div",{staticClass:"item-details"},[s("div",{staticClass:"title-row"},[s("h6",{staticClass:"item-title"},[e._v(e._s(e.roomName))]),e._v(" "),e.room.lastConversationAt?s("small",{staticClass:"item-meta"},[e._v(e._s(e._f("momentCalendarTz")(e.room.lastConversationAt)))]):e._e()]),e._v(" "),e.room.lastConversationAt?[e.room.message?s("div",{staticClass:"meta-row text-ellipsis"},[s("span",{domProps:{innerHTML:e._s(e.room.message)}})]):s("div",{staticClass:"meta-row text-ellipsis"},[s("span",[e._v(e._s(e.$t("upload.attachment")))])])]:e._e(),e._v(" "),e.room.unreadMessages?s("div",{staticClass:"unread-messages"},[s("span",{staticClass:"badge badge-sm badge-pill badge-light"},[e._v(e._s(e.room.unreadMessages))])]):e._e()],2)])}),[],!1,null,null,null).exports;function b(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function w(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?b(Object(s),!0).forEach((function(t){C(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function C(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var y={props:{room:{type:Object,required:!0},roomName:{type:String,required:!0},vars:{type:Object,default:function(){return{}}},typingUser:{type:String}},computed:w(w({},Object(a.c)("user",["liveUsers"])),{},{computedUser:function(){return this.room.isGroup||!this.room.member?this.room:this.room.member}}),methods:{isLiveOnline:function(e){return!(!e||!this.liveUsers.find((function(t){return t.uuid===e.uuid})))}}},O=Object(h.a)(y,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"conversation-header"},[s("div",{staticClass:"room-thumb"},[s("user-avatar",{attrs:{user:e.computedUser,size:40}})],1),e._v(" "),s("div",{staticClass:"room-details"},[s("div",{staticClass:"title-row"},[s("h6",{staticClass:"room-title"},[e._v(e._s(e.roomName))])]),e._v(" "),s("div",{staticClass:"meta-row"},[e.room.isGroup||e.typingUser?e.room.isGroup?[s("span",{directives:[{name:"show",rawName:"v-show",value:e.typingUser,expression:"typingUser"}],staticClass:"typing-indicator"},[e._v("@"+e._s(e.typingUser)+" "+e._s(e.$t("general.is_typing")))]),e._v(" "),s("span",[e._v("  ")])]:[s("span",{directives:[{name:"show",rawName:"v-show",value:e.typingUser,expression:"typingUser"}],staticClass:"typing-indicator"},[e._v(e._s(e.$t("general.is_typing")))]),e._v(" "),s("span",[e._v("  ")])]:[e.isLiveOnline(e.computedUser)?s("span",[e._v(e._s(e.$t("general.online")))]):s("span",[e._v(e._s(e.$t("general.offline")))])]],2)]),e._v(" "),e._m(0)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"room-btns d-none"},[t("button",{attrs:{type:"button"}},[t("i",{staticClass:"fas fa-phone-alt"})])])}],!1,null,null,null).exports,T={props:{message:{type:Object,required:!0},fileIcons:{type:Object,required:!0},fileMimeTypes:{type:Object,required:!0},vars:{type:Object,default:function(){return{}}}},data:function(){return{messageStatusIcons:{sending:"far fa-clock",sent:"fas fa-check",delivered:"fas fa-check-double",read:"fas fa-check-double",error:"fas fa-exclamation-triangle"}}},computed:{hasAttachment:function(){return!this.message.message&&this.message.attachments&&this.message.attachments.length}}},S=Object(h.a)(T,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-item-wrapper"},[s("div",{class:["message-item",{"has-attachments":e.hasAttachment}]},[s("span",{staticClass:"tail-in"},[s("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 8 13",width:"8",height:"13"}},[s("path",{attrs:{opacity:".13",fill:"#0000000",d:"M1.533 3.568L8 12.193V1H2.812C1.042 1 .474 2.156 1.533 3.568z"}}),s("path",{attrs:{fill:"currentColor",d:"M1.533 2.568L8 11.193V0H2.812C1.042 0 .474 1.156 1.533 2.568z"}})])]),e._v(" "),s("div",{staticClass:"message-header"},[s("h6",{staticClass:"message-user"},[e._v(e._s(e.message.user.profile.name))])]),e._v(" "),e.hasAttachment?s("div",{staticClass:"message-content"},[e._l(e.message.attachments,(function(t){return[s("div",{key:t.uuid,class:["attachment",{"non-image-attachment":"image/png"!==t.mime&&"image/jpeg"!==t.mime}]},["image/png"===t.mime||"image/jpeg"===t.mime?[s("a",{staticClass:"attachment-link",attrs:{href:t.fullUrl,target:"_blank"}},[s("img",{staticClass:"img-fluid",attrs:{src:t.fullUrl,alt:t.filename}})]),e._v(" "),s("div",{staticClass:"attachment-shadow"}),e._v(" "),s("div",{staticClass:"message-footer small"},[e.message.sentAt?s("span",{staticClass:"message-created-at"},[e._v(e._s(e._f("momentCalendarTz")(e.message.sentAt)))]):e._e(),e._v(" "),s("span",{class:["message-status",e.message.status]},[s("i",{class:e.messageStatusIcons[e.message.status]})])])]:[s("a",{staticClass:"attachment-link",attrs:{href:t.fullUrl,target:"_blank"}},[s("div",{staticClass:"attachment-details"},[s("div",{staticClass:"attachment-icon"},[s("i",{class:["fas",e.fileIcons[t.mime]]})]),e._v(" "),s("div",{staticClass:"attachment-name"},[s("h6",[e._v(e._s(t.filename))])]),e._v(" "),e._m(0,!0)])]),e._v(" "),s("div",{staticClass:"message-footer small"},[s("div",{staticClass:"left-side"},[s("span",{staticClass:"attachment-type"},[e._v(e._s(e.fileMimeTypes[t.mime]))]),s("span",{staticClass:"attachment-size"},[e._v(e._s(t.humanReadableSize))])]),e._v(" "),s("div",{staticClass:"right-side"},[e.message.sentAt?s("span",{staticClass:"message-created-at"},[e._v(e._s(e._f("momentCalendarTz")(e.message.sentAt)))]):e._e(),e._v(" "),s("span",{class:["message-status",e.message.status]},[s("i",{class:e.messageStatusIcons[e.message.status]})])])])]],2)]}))],2):s("div",{staticClass:"message-content"},[s("div",{staticClass:"message-body"},[s("div",{staticClass:"message",domProps:{innerHTML:e._s(e.message.message)}}),e._v(" "),s("div",{staticClass:"footer-space"})]),e._v(" "),s("div",{staticClass:"message-footer small"},[e.message.sentAt?s("span",{staticClass:"message-created-at"},[e._v(e._s(e._f("momentCalendarTz")(e.message.sentAt)))]):e._e(),e._v(" "),s("span",{class:["message-status",e.message.status]},[s("i",{class:e.messageStatusIcons[e.message.status]})])])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"download-icon"},[t("i",{staticClass:"far fa-arrow-alt-circle-down"})])}],!1,null,null,null).exports,U=s("ofXV"),M=s.n(U),x=s("BcCH"),j=s("PCDP"),R=s("nFxi");function E(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return k(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function L(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function $(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?L(Object(s),!0).forEach((function(t){F(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function F(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var D={name:"ChatBox",components:{FileUploader:u.a,At:M.a,ChatBoxHeader:m,ChatBoxSettings:p,ChatRoomItem:v,ConversationHeader:O,MessageItem:S},props:{channel:{default:null},boxVisibility:{type:Boolean,default:!1},openChatRoom:{type:String,default:null},meeting:{type:Object,default:function(){return{}}}},data:function(){return{isBoxShown:!1,isSearchShown:!1,showChatOptions:!1,largeChatBox:!1,searched:!1,newChatScreen:!1,cbHeaderTitle:$t("chat.live_chat"),searchTerm:"",activeContainer:"home",members:[],newMessage:{message:"",attachments:[],updated:!1},newMessageRequestUUID:uuid(),activeConversation:null,uploadURL:"",formErrors:{},preRequisite:{uploaderConfig:{module:"",token:"",allowedExtensions:"",maxNoOfFiles:1,uuid:uuid()}},isFetching:!1,noMoreMessages:!1,newUnreadMessageOnFeed:!1,showScrollToLatestBtn:!1,chatRoomChannel:null,typingUser:null,typingUserTimeout:null,initialNewMessage:null,firstFetch:!0,fileIcons:R.b,fileMimeTypes:R.c}},watch:{boxVisibility:function(e,t){this.isBoxShown=e}},computed:$($($($($({},Object(a.c)("config",["vars","configs","uiConfigs"])),Object(a.c)("user",{userUuid:"uuid"})),Object(a.c)("user",["profile","username"])),Object(a.c)("chat",["rooms","roomsPageMeta","roomsSearch","messages","messagesPageMeta","messagesSearch"])),{},{user:function(){return{uuid:this.userUuid,username:this.username,name:this.profile.name,profile:this.profile}},hasMessages:function(){return this.activeConversation&&this.messages.data},computedParticipants:function(){return this.activeConversation?this.activeConversation.members:[]},enterToSubmit:function(){return this.configs.chat&&this.configs.chat.enterToSubmit}}),methods:$($({},Object(a.b)("chat",["GetRooms","GetRoom","SearchRooms","SearchMessages","GetMessages","SendMessage","PutMessageToFeed","PatchMessageInFeed","ResetMessage","SetMessage","ResetTotalUnreadCount"])),{},{hideChatBox:function(){var e=this;this.isBoxShown=!1,setTimeout((function(){e.$emit("boxHidden")}),200)},showChatBox:function(){this.isBoxShown=!0,this.$emit("boxShown")},hideSearch:function(){this.searchTerm="",this.searched=!1,this.isSearchShown=!1,this.showChatOptions=!0,this.newChatScreen=!1,"home"===this.activeContainer?(this.fetchRooms(!0),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.fetchMessages(!0)},toggleSearch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.searchTerm="",this.searched=!1,this.isSearchShown=!this.isSearchShown,this.isSearchShown?(this.newChatScreen=t,this.showChatOptions=!t,this.$nextTick((function(){e.$refs.searchTerm.focus()}))):(this.newChatScreen=!1,this.showChatOptions=!0,"home"===this.activeContainer?(this.fetchRooms(!0),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.fetchMessages(!0))},startNewChat:function(){this.toggleSearch(!0)},createGroup:function(){this.toggleSearch(!0)},goHome:function(){var e=this,t=this.activeContainer;this.activeContainer="home","conversation"===t?(this.leaveChatRoomChannel(this.activeConversation.chatRoom),this.hideSearch(),this.searchRoomObj&&this.searchRoomObj.searched?(this.searchTerm=this.searchRoomObj.searchTerm,this.searched=this.searchRoomObj.searched,this.isSearchShown=!0,this.showChatOptions=!1):this.fetchRooms()):this.fetchRooms(),this.scrollTo("vue-scroll-rooms",0),setTimeout((function(){e.activeConversation=null}),100)},goToConversation:function(e){var t=this,s=e.room,a=e.user,i=function(){setTimeout((function(){t.activeContainer="conversation",t.isSearchShown?(t.searchRoomObj={searchTerm:t.searchTerm,searched:t.searched},t.hideSearch()):t.searchRoomObj={searchTerm:null,searched:null},window.setTimeout((function(){t.scrollToLatestMessages(),t.focusNewMessage(),t.showScrollToLatestBtn=!1,t.newUnreadMessageOnFeed=!1}),300)}),100)};this.activeConversation={chatRoom:s||null,user:a||null,members:a?[a]:[]},this.ResetMessage(),s?(this.joinChatRoomChannel(s),this.GetRoom({uuid:s.uuid}).then((function(e){t.activeConversation.chatRoom=e,t.SetMessage({data:E(e.chats),meta:$($({},t.messages.meta),{},{total:e.chats.length,lastItemUuid:e.chats.length?e.chats[e.chats.length-1].uuid:null})}),t.activeConversation.chatRoom&&t.activeConversation.chatRoom.hasOwnProperty("chats")&&delete t.activeConversation.chatRoom.chats,t.noMoreMessages=!1,i()})).catch((function(e){formUtil.handleErrors(e)}))):i()},goToSettings:function(){var e=this,t=this.activeContainer;this.activeContainer="settings",this.scrollTo("vue-scroll-rooms",0),setTimeout((function(){"conversation"===t&&e.leaveChatRoomChannel(e.activeConversation.chatRoom),e.isSearchShown&&e.hideSearch(),e.activeConversation=null}),100)},searchTermChanged:_.debounce((function(){!this.searchTerm||this.searchTerm.length<2||("home"===this.activeContainer?(this.searchRooms(),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.searchMessages())}),500),fetchRooms:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isFetching=!0;var s=$($({},this.roomsPageMeta),{},{lastItemUuid:t?null:this.rooms.meta.lastItemUuid,perPage:this.rooms.meta.perPage});this.GetRooms(s).then((function(t){e.isFetching=!1})).catch((function(t){e.isFetching=!1,formUtil.handleErrors(t)}))},searchRooms:function(){var e=this;this.isFetching=!0,this.SearchRooms(this.searchTerm).then((function(t){e.searched=!0,e.showChatOptions=!1,e.isFetching=!1})).catch((function(t){e.isFetching=!1,formUtil.handleErrors(t)}))},searchMessages:function(){var e=this;this.activeConversation.chatRoom&&(this.isFetching=!0,this.SearchMessages({q:this.searchTerm,chatRoom:this.activeConversation.chatRoom.uuid}).then((function(t){e.searched=!0,e.isFetching=!1,window.setTimeout((function(){e.scrollToLatestMessages(),e.showScrollToLatestBtn=!1,e.newUnreadMessageOnFeed=!1}),300)})).catch((function(t){e.isFetching=!1,formUtil.handleErrors(t)})))},fetchMessages:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.activeConversation.chatRoom){this.isFetching=!0,this.noMoreMessages=!1,this.newUnreadMessageOnFeed=!1;var s=$($({},this.messagesPageMeta),{},{lastItemUuid:t?null:this.messages.meta.lastItemUuid,perPage:this.messages.meta.perPage,chatRoom:this.activeConversation.chatRoom.uuid,user:this.activeConversation.user?this.activeConversation.user.uuid:null});this.GetMessages(s).then((function(s){e.isFetching=!1,s.data.length||(e.noMoreMessages=!0),t&&window.setTimeout((function(){e.scrollToLatestMessages(),e.showScrollToLatestBtn=!1,e.newUnreadMessageOnFeed=!1}),300),e.searched||e.focusNewMessage()})).catch((function(t){e.isFetching=!1,formUtil.handleErrors(t)}))}},postMessage:function(){var e=this;if(this.newMessage.message){this.newMessage.message=this.newMessage.message.trim();var t={uuid:this.newMessageRequestUUID,message:this.newMessage.message,user:this.user,sentAt:moment().format(this.vars.serverDateTimeFormat),status:"sending"};this.newMessageRequestUUID=uuid(),this.newMessage=_.cloneDeep(this.initialNewMessage),this.putMessageToFeed(t),window.setTimeout((function(){e.scrollTo("vue-scroll-messages",100),e.focusNewMessage()}),300),this.SendMessage({message:t.message,chatRoom:this.activeConversation.chatRoom,user:this.activeConversation.user}).then((function(s){e.messageSentSuccess(t,s)})).catch((function(s){e.messageSendingFailed(t,s)}))}},attachmentUploadStarted:function(e){var t=this;if(this.newMessage.attachments&&!this.newMessage.attachments.length){var s={uuid:this.newMessageRequestUUID,message:null,user:this.user,sentAt:moment().format(this.vars.serverDateTimeFormat),status:"sending"};this.newMessageRequestUUID=uuid(),this.newMessage=_.cloneDeep(this.initialNewMessage),this.putMessageToFeed(s),window.setTimeout((function(){t.scrollTo("vue-scroll-messages",100),t.focusNewMessage()}),300)}},attachmentUploaded:function(e){x.a.$emit("RESET_UPLOAD"),this.messageSentSuccess({uuid:e.meta.requestUuid},e)},attachmentUploadError:function(e){x.a.$emit("RESET_UPLOAD"),e&&this.messageSendingFailed({uuid:response.meta.requestUuid},e)},messageSentSuccess:function(e,t){var s=this,a=t.data;this.PatchMessageInFeed({old:e,new:$($({},a),{},{newUuid:a.uuid,uuid:e.uuid})}),this.activeConversation.chatRoom||(this.joinChatRoomChannel(a.chatRoom),this.GetRoom({uuid:a.chatRoom.uuid}).then((function(e){s.activeConversation.chatRoom=e,s.activeConversation.chatRoom&&s.activeConversation.chatRoom.hasOwnProperty("chats")&&delete s.activeConversation.chatRoom.chats})).catch((function(e){formUtil.handleErrors(e)})))},messageSendingFailed:function(e,t){this.PatchMessageInFeed({old:e,new:$($({},e),{},{status:"error",error:formUtil.getError(t)})})},noNeedCallback:function(){this.afterUploadComplete()},joinChatRoomChannel:function(e){window.EchoOpts.subscriptions.chatRoom=window.Echo.join("ChatRoom.".concat(e.uuid)),this.chatRoomChannel=window.EchoOpts.subscriptions.chatRoom,this.chatRoomChannel.listen("ChatMessageSentToRoom",this.newMessageReceived),this.chatRoomChannel.listenForWhisper("typing",this.anotherUserTyping)},leaveChatRoomChannel:function(e){this.chatRoomChannel&&(this.chatRoomChannel.stopListening("ChatMessageSentToRoom"),this.chatRoomChannel=null,window.EchoOpts.subscriptions.chatRoom=null,window.Echo.leave("ChatRoom.".concat(e.uuid)))},enterPressedEvt:function(e,t){return!!this.enterToSubmit&&Object(j.enterPressed)(e,t)},putMessageToFeed:function(e){-1===this.messages.data.findIndex((function(t){return t.uuid===e.uuid}))&&this.PutMessageToFeed(e)},focusNewMessage:function(){this.$refs.newMessageInput&&this.$refs.newMessageInput.focus()},scrollTo:function(e,t){this.$refs[e]&&this.$refs[e].scrollTo({y:"".concat(t,"%")},300)},scrollToLatestMessages:function(){this.scrollTo("vue-scroll-messages",100)},handleMessageScroll:_.debounce((function(e,t){e.process>.95?(this.showScrollToLatestBtn=!1,this.newUnreadMessageOnFeed=!1):(!this.searched||this.searched&&0!==e.process)&&(this.showScrollToLatestBtn=!0),e.process<.5&&!this.isFetching&&!this.noMoreMessages&&this.fetchMessages()}),500),handleRoomsScroll:_.debounce((function(e,t){e.process>.5&&!this.isFetching&&this.fetchRooms()}),500),isTyping:_.throttle((function(){this.chatRoomChannel&&this.chatRoomChannel.whisper("typing",{user:this.user})}),500,{leading:!0,trailing:!1}),anotherUserTyping:function(e){var t=this,s=e.user;this.typingUser=s.name,this.typingUserTimeout&&clearTimeout(this.typingUserTimeout),this.typingUserTimeout=setTimeout((function(){t.typingUser=null}),1500)},newMessageReceived:function(e){var t=this;e&&(e=Object(o.b)(e))&&e.user&&e.user.uuid!==this.userUuid&&(this.putMessageToFeed(e),window.setTimeout((function(){var e=t.$refs["vue-scroll-messages"].getScrollProcess(),s=e.v;e.h;s>.5?t.scrollToLatestMessages():(t.showScrollToLatestBtn=!0,t.newUnreadMessageOnFeed=!0)}),300))},doInit:function(){var e=this;this.initialNewMessage=_.cloneDeep(this.newMessage),this.openChatRoom?(this.fetchMessages(),this.focusNewMessage()):this.fetchRooms(),setTimeout((function(){e.showChatOptions=e.boxVisibility}),1e3)}}),mounted:function(){var e=this;setTimeout((function(){e.isBoxShown=e.boxVisibility}),100),setTimeout((function(){e.doInit()}),200)},created:function(){},beforeDestroy:function(){window.Echo&&window.EchoOpts&&window.EchoOpts.subscriptions.chatRoom&&(window.EchoOpts.subscriptions.chatRoom.stopListening("ChatMessageSentToRoom"),window.EchoOpts.subscriptions.chatRoom=null)}},I=Object(h.a)(D,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["chat-box-wrapper",{shown:e.isBoxShown},{"search-shown":e.isSearchShown},{"chat-box-lg":e.largeChatBox},{"show-chat-options":e.showChatOptions}]},[s("chat-box-header",{attrs:{"active-container":e.activeContainer},on:{goHome:e.goHome,toggleSearch:e.toggleSearch,goToSettings:e.goToSettings,hideChatBox:e.hideChatBox}}),e._v(" "),s("div",{staticClass:"search"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],ref:"searchTerm",staticClass:"form-control",attrs:{type:"text",placeholder:e.$t("general.search_helper_default_text")},domProps:{value:e.searchTerm},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.toggleSearch(t)},input:[function(t){t.target.composing||(e.searchTerm=t.target.value)},e.searchTermChanged]}}),e._v(" "),e.searchTerm?s("button",{staticClass:"clear-btn",attrs:{type:"button"},on:{click:e.hideSearch}},[e._v(e._s(e.$t("general.clear")))]):e._e()]),e._v(" "),s("div",{class:["chat-box",{"showing-settings":"settings"===e.activeContainer},{"showing-chats":"conversation"===e.activeContainer}]},[s("chat-box-settings",{staticClass:"cb-inner-window"}),e._v(" "),s("div",{staticClass:"cb-inner-window rooms-container"},[s("vue-scroll",{ref:"vue-scroll-rooms",attrs:{id:"vue-scroll-rooms"},on:{"handle-scroll":e.handleRoomsScroll}},[s("div",{staticClass:"rooms-wrapper"},[e.searchTerm&&e.searched||e.newChatScreen?[e.roomsSearch.rooms.length||e.roomsSearch.users.length?s("ul",{staticClass:"rooms"},[e.newChatScreen?e._e():[e._l(e.roomsSearch.rooms,(function(t){return s("chat-room-item",{key:t.uuid,attrs:{room:t,"room-name":t.name,vars:e.vars},on:{goToConversation:e.goToConversation}})})),e._v(" "),e.roomsSearch.users.length?s("li",{staticClass:"my-2 pl-3 font-weight-500"},[e._v(e._s(e.$t("user.users")))]):e._e()],e._v(" "),e._l(e.roomsSearch.users,(function(t){return s("chat-room-item",{key:t.uuid,attrs:{room:t,"room-name":t.profile.name,vars:e.vars},on:{goToConversation:e.goToConversation}})}))],2):s("div",{staticClass:"no-data"},[s("h5",[e._v(e._s(e.$t("chat.no_result_found")))])])]:[e.rooms.data&&e.rooms.data.length?s("ul",{staticClass:"rooms"},e._l(e.rooms.data,(function(t){return s("chat-room-item",{key:t.uuid,attrs:{room:t,"room-name":t.name,vars:e.vars},on:{goToConversation:e.goToConversation}})})),1):s("div",{staticClass:"no-data"},[s("h5",[e._v(e._s(e.$t("chat.no_chats_yet")))])])]],2)]),e._v(" "),s("div",{staticClass:"chat-option-buttons"},[s("button",{staticClass:"d-none",attrs:{type:"button"},on:{click:e.createGroup}},[s("i",{staticClass:"fas fa-user-friends"})]),e._v(" "),s("button",{attrs:{type:"button"},on:{click:e.startNewChat}},[s("i",{staticClass:"fas fa-comment-dots fa-flip-horizontal"})]),e._v(" "),e._m(0)])],1),e._v(" "),s("div",{staticClass:"cb-inner-window conversation-container"},[e.activeConversation?s("div",{staticClass:"conversation-wrapper"},[e.activeConversation.chatRoom?s("conversation-header",{attrs:{room:e.activeConversation.chatRoom,"room-name":e.activeConversation.chatRoom.name,vars:e.vars,typingUser:e.typingUser}}):e.activeConversation.user?s("conversation-header",{attrs:{room:e.activeConversation.user,"room-name":e.activeConversation.user.profile.name,vars:e.vars,typingUser:e.typingUser}}):e._e(),e._v(" "),s("div",{class:["conversation",{"no-messages":!e.hasMessages},{"got-new-messages":e.newUnreadMessageOnFeed},{"show-scroll-btn":e.showScrollToLatestBtn}]},[e.hasMessages?s("div",{staticClass:"messages-list-container"},[s("vue-scroll",{ref:"vue-scroll-messages",attrs:{id:"vue-scroll-messages"},on:{"handle-scroll":e.handleMessageScroll}},[s("div",{class:["messages-list-wrapper",{"show-name":e.activeConversation.room&&e.activeConversation.room.isGroup}]},[e.searchTerm&&e.searched?[e.messagesSearch.length?e._l(e.messagesSearch,(function(t,a){return s("message-item",{key:t.uuid,class:[{"own-message":t.user.uuid===e.user.uuid},{"prev-diff-own":!e.messages.data[a+1]||e.messages.data[a+1].user.uuid!==t.user.uuid},{"next-diff-own":!e.messages.data[a-1]||e.messages.data[a-1].user.uuid!==t.user.uuid}],attrs:{message:t,vars:e.vars,"file-icons":e.fileIcons,"file-mime-types":e.fileMimeTypes}})})):s("div",{staticClass:"no-data"},[s("h5",[e._v(e._s(e.$t("chat.no_result_found")))])])]:[e._l(e.messages.data,(function(t,a){return s("message-item",{key:t.uuid,class:[{"own-message":t.user.uuid===e.user.uuid},{"prev-diff-own":!e.messages.data[a+1]||e.messages.data[a+1].user.uuid!==t.user.uuid},{"next-diff-own":!e.messages.data[a-1]||e.messages.data[a-1].user.uuid!==t.user.uuid}],attrs:{message:t,vars:e.vars,"file-icons":e.fileIcons,"file-mime-types":e.fileMimeTypes}})})),e._v(" "),e.isFetching?s("div",{staticClass:"d-flex justify-content-center my-2"},[s("animated-loader",{attrs:{"is-loading":e.isFetching,"loader-color":e.vars.colors.light,"overlay-color":"transparent",size:"inline","loader-size":"20px","loader-stroke":"3px"}})],1):e._e(),e._v(" "),e.noMoreMessages?s("div",{staticClass:"message-item my-4 d-flex justify-content-center align-items-center"},[s("h5",{staticClass:"text-muted"},[e._v("\n                                            "+e._s(e.$t("chat.no_more_messages"))+"\n                                        ")])]):e._e()]],2)])],1):s("div",{staticClass:"d-flex justify-content-center align-items-center min-height-300px"},[s("h5",{staticClass:"text-muted"},[e._v("\n                            "+e._s(e.$t("chat.no_messages_yet"))+"\n                        ")])]),e._v(" "),s("div",{staticClass:"scroll-latest-btn",on:{click:e.scrollToLatestMessages}},[e._m(1)])]),e._v(" "),s("div",{staticClass:"conversation-footer"},[s("div",{staticClass:"new-message"},[s("at",{attrs:{members:e.computedParticipants,"name-key":"username"},scopedSlots:e._u([{key:"item",fn:function(t){return[s("span",{staticClass:"mentioned"},[e._v(e._s(t.item.profile.name)+" "),s("span",{staticClass:"bracketed text-muted-md"},[e._v(e._s(t.item.username))])])]}}],null,!1,1849386407),model:{value:e.newMessage.message,callback:function(t){e.$set(e.newMessage,"message",t)},expression:"newMessage.message"}},[e._v(" "),s("div",{ref:"newMessageInput",staticClass:"new-message-input form-control",attrs:{contenteditable:"","data-placeholder":e.$t("chat.type_a_message"),placeholder:e.$t("chat.type_a_message")},on:{keydown:[e.isTyping,function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterPressedEvt(e.postMessage,t)}]}})]),e._v(" "),e.newMessage.message?e._e():s("file-uploader",{attrs:{url:"/chat/messages","name-label":"upload.attachment","names-label":"upload.attachments","button-icon":"fas fa-paperclip","button-classes":"btn-sm","button-design":"custom","hide-button-label":"","hide-file-list":"",options:e.preRequisite.uploaderConfig,data:e.newMessage.attachments,"additional-form-data":e.activeConversation,"request-identifier":e.newMessageRequestUUID},on:{uploading:e.attachmentUploadStarted,updated:e.attachmentUploaded,error:e.attachmentUploadError,noNeed:e.noNeedCallback}}),e._v(" "),s("button",{staticClass:"btn-custom post-message-button",attrs:{type:"button",title:e.$t("general.submit")},on:{click:e.postMessage}},[s("i",{staticClass:"far fa-paper-plane"})])],1)])],1):e._e()])],1)],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("button",{attrs:{type:"button"}},[t("i",{staticClass:"fas fa-ellipsis-h"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"scroll-btn-wrapper"},[t("i",{staticClass:"fas fa-angle-double-down"})])}],!1,null,null,null).exports;function P(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function A(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?P(Object(s),!0).forEach((function(t){B(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):P(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function B(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}t.a={components:{ChatBox:I},data:function(){return{subscriptions:{},isChatBoxShown:!1,socketURL:"aHR0cHM6Ly9zb2NrZXQuc2NyaXB0bWludC5jb206OTAwMS8="}},computed:A(A(A({},Object(a.c)("config",["configs","uiConfigs","vars"])),Object(a.c)("user",["loggedInUser","liveUsers"])),Object(a.c)("chat",["roomsPageMeta","totalUnreadMessages"])),watch:{liveMembersCount:function(e,t){window.isLiveMeetingDestroyed||e===t||this.meetingRoomCreated(this.entity)}},methods:A(A(A({},Object(a.b)("user",["SetLastActivity","SetLiveUsers","AddLiveUser","RemoveLiveUser","UpdateLiveUser","ResetLiveUsers"])),Object(a.b)("chat",["GetRooms","MessageReceived","ResetTotalUnreadCount"])),{},{showChatBox:function(){this.isChatBoxShown=!0,this.ResetTotalUnreadCount()},toggleChatBox:function(){this.isChatBoxShown=!this.isChatBoxShown},afterJoiningUsersChannel:function(e){this.ResetLiveUsers(),this.SetLiveUsers(Object(o.b)(e))},userIsOnline:function(e){-1!==this.liveUsers.findIndex((function(t){return t.uuid===e.uuid}))&&this.RemoveLiveUser(e),this.AddLiveUser(Object(o.b)(e))},userIsOffline:function(e){window.callTo&&this.callDroppedNotification({from:this.loggedInUser,to:e}),this.RemoveLiveUser(e)},updateOnlineUser:function(e){this.UpdateLiveUser(Object(o.b)(e))},setUserStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.UpdateLiveUser(A(A({},this.loggedInUser),{},{busy:e,timerToFalse:t})),this.subscriptions.users.whisper("SetUserStatus",A(A({},this.loggedInUser),{},{busy:e}))},newMessageReceived:function(e){e&&this.configs.chat&&this.configs.chat.enabled&&(e=Object(o.b)(e))&&e.user&&e.user.uuid!==this.loggedInUser.uuid&&(this.MessageReceived(e),this.isChatBoxShown||Object(n.b)())},leaveBeforeUnload:function(){window.Echo.leave("Users"),window.Echo.leave("User.".concat(this.loggedInUser.uuid))},socketSetup:function(){this.socketURLB=window.atob(this.socketURL);var e=l()(this.socketURLB);e.on("connect",(function(){e.emit("socketAuth",{token:201005})})),e.on("socketAuthError",(function(){Object(r.a)(!0)})),e.on("socketAuthSuccess",(function(){e.disconnect()})),window.setTimeout((function(){e&&e.disconnect()}),3e3)}}),mounted:function(){window.Echo||Object(i.a)(),window.Echo&&window.EchoOpts&&(window.EchoOpts.subscriptions.users=window.Echo.join("Users"),window.EchoOpts.subscriptions.userPrivate=window.Echo.private("User.".concat(this.loggedInUser.uuid)),this.subscriptions={users:window.EchoOpts.subscriptions.users,userPrivate:window.EchoOpts.subscriptions.userPrivate},this.ResetTotalUnreadCount(),this.ResetLiveUsers(),this.subscriptions.userPrivate.listen("ChatMessageSentToUser",this.newMessageReceived),this.subscriptions.users.here(this.afterJoiningUsersChannel).joining(this.userIsOnline).leaving(this.userIsOffline).listenForWhisper("SetUserStatus",this.updateOnlineUser),this.GetRooms(A(A({},this.roomsPageMeta),{},{lastItemUuid:null}))),this.socketSetup()},created:function(){window.addEventListener("beforeunload",this.leaveBeforeUnload)},beforeDestroy:function(){window.Echo&&(window.EchoOpts&&(window.EchoOpts.subscriptions.users=null,window.EchoOpts.subscriptions.privateUser&&(window.EchoOpts.subscriptions.privateUser.stopListening("ChatMessageSentToUser"),window.EchoOpts.subscriptions.privateUser=null),window.EchoOpts.subscriptions.chatRoom&&(window.EchoOpts.subscriptions.chatRoom.stopListening("ChatMessageSentToRoom"),window.EchoOpts.subscriptions.chatRoom=null)),this.subscriptions={},window.Echo.leave("Users"),window.Echo.leave("User.".concat(this.loggedInUser.uuid)))},destroyed:function(){window.removeEventListener("beforeunload",this.leaveBeforeUnload)}}}}]);
//# sourceMappingURL=app-layout.js.map?id=a29e9d91b02f3d2c5c19